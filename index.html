<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Animeverse — Local Fan Hub (Text app)</title>
<style>
  :root{
    --bg:#07060a; --card:#0f1724; --accent:#8b5cf6; --accent2:#06b6d4; --muted:#9aa7c7;
    --glass: rgba(255,255,255,0.03);
  }
  *{box-sizing:border-box;font-family:Inter,system-ui,Arial,sans-serif}
  body{margin:0;min-height:100vh;background:linear-gradient(180deg,#02020a,var(--bg));color:#eef2ff}
  header{position:sticky;top:0;background:linear-gradient(180deg,rgba(0,0,0,0.25),transparent);backdrop-filter:blur(6px);border-bottom:1px solid rgba(255,255,255,0.03);z-index:20}
  .wrap{max-width:1100px;margin:0 auto;padding:12px}
  .top{display:flex;align-items:center;justify-content:space-between;gap:12px}
  .brand{display:flex;gap:12px;align-items:center}
  .logo{width:56px;height:56px;border-radius:10px;display:flex;align-items:center;justify-content:center;background:linear-gradient(90deg,var(--accent),var(--accent2));font-weight:800;color:#071028}
  nav{display:flex;gap:8px;flex-wrap:wrap}
  nav button{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px 12px;border-radius:9px;color:inherit;cursor:pointer}
  nav button.active{border-color:var(--accent);box-shadow:0 8px 24px rgba(139,92,246,0.06);background:linear-gradient(90deg,rgba(139,92,246,0.06),rgba(6,182,212,0.02))}
  main{max-width:1100px;margin:18px auto;padding:0 12px}
  .card{background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);border:1px solid rgba(255,255,255,0.03);padding:14px;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,0.6)}
  .hero{display:grid;grid-template-columns:1fr 340px;gap:18px;align-items:start}
  h1{margin:0;font-size:1.6rem}
  .muted{color:var(--muted)}
  .search{display:flex;gap:8px;margin-top:12px}
  .search input{flex:1;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:inherit}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px;margin-top:12px}
  .anime-card{padding:10px;border-radius:8px;background:var(--card);cursor:pointer;transition:transform .18s;display:flex;flex-direction:column;gap:8px}
  .anime-card:hover{transform:translateY(-6px)}
  .anime-card img{width:100%;height:160px;object-fit:cover;border-radius:8px}
  .label{font-weight:700}
  .nav-crumbs{display:flex;gap:8px;align-items:center;margin-top:8px}
  .small{font-size:0.9rem}
  .page{display:none}
  .page.active{display:block}
  .season{background:linear-gradient(90deg,rgba(255,255,255,0.01),transparent);padding:10px;border-radius:8px}
  .episodes{display:flex;flex-direction:column;gap:8px;margin-top:8px}
  .episode{padding:8px;background:rgba(255,255,255,0.02);border-radius:8px;display:flex;justify-content:space-between;align-items:center}
  .chat{height:260px;overflow:auto;padding:8px;border-radius:8px;background:#06060a;border:1px solid rgba(255,255,255,0.02)}
  .chat .msg{margin-bottom:8px}
  textarea,input{padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:inherit}
  .btn{padding:8px 10px;border-radius:8px;border:none;background:linear-gradient(90deg,var(--accent),var(--accent2));color:#071028;cursor:pointer}
  .gallery img{width:100%;height:160px;object-fit:cover;border-radius:8px}
  footer{padding:20px;text-align:center;color:var(--muted);margin-top:20px}
  @media(max-width:900px){.hero{grid-template-columns:1fr}.logo{width:48px;height:48px}}
</style>
</head>
<body>
<header>
  <div class="wrap top">
    <div class="brand">
      <div class="logo">AV</div>
      <div>
        <div style="font-weight:800">Animeverse (Local Demo)</div>
        <div class="muted small">Works in Text app — local browser data only</div>
      </div>
    </div>

    <nav id="mainNav">
      <button data-route="home" class="active">Home</button>
      <button data-route="discover">Discover</button>
      <button data-route="gallery">Gallery</button>
      <button data-route="watch">Watch</button>
      <button data-route="chat">General Chat</button>
      <button data-route="rules">Rules</button>
    </nav>
  </div>
</header>

<main class="wrap">
  <!-- HOME -->
  <section id="home" class="page active">
    <div class="hero">
      <div class="card">
        <h1>Welcome to Animeverse</h1>
        <p class="muted">A local, offline fan hub you can edit in your Text app. Click an anime to see seasons, episodes, summaries, and local per-episode chats.</p>

        <div class="search">
          <input id="searchInput" placeholder="Search anime (try: Demon Slayer, Naruto, One Piece...)" />
          <button id="searchBtn" class="btn">Search</button>
        </div>

        <h3 style="margin-top:12px">Popular picks</h3>
        <div id="popularGrid" class="grid"></div>

        <h3 style="margin-top:14px">Featured movies</h3>
        <div id="movieGrid" class="grid"></div>

      </div>

      <aside style="width:100%;max-width:340px">
        <div class="card">
          <h3>Quick tips</h3>
          <ul class="muted small">
            <li>To add or edit anime data: open this file in Text and edit the <code>animeData</code> variable in the script.</li>
            <li>Chat saves locally in your browser. To clear chats, use the <strong>Clear Local Data</strong> button on the General Chat page.</li>
            <li>To publish later, upload this file and its assets to GitHub Pages/Netlify.</li>
          </ul>
          <div style="margin-top:12px">
            <button class="btn" onclick="renderPopular()">Refresh list</button>
          </div>
        </div>
      </aside>
    </div>
  </section>

  <!-- DISCOVER / ANIME LIST -->
  <section id="discover" class="page card">
    <div class="nav-crumbs"><span class="muted">Browse all anime</span></div>
    <div id="animeList" class="grid" style="margin-top:12px"></div>
  </section>

  <!-- GALLERY -->
  <section id="gallery" class="page card">
    <h2>Gallery</h2>
    <p class="muted">Add your GIF/image URLs in the code or right here using the "Add Image" form.</p>
    <div style="display:flex;gap:8px;margin-top:8px">
      <input id="imgUrl" placeholder="Paste image or gif URL here" style="flex:1">
      <button class="btn" id="addImgBtn">Add Image</button>
    </div>
    <div id="galleryGrid" class="grid" style="margin-top:12px"></div>
  </section>

  <!-- WATCH (legal links) -->
  <section id="watch" class="page card">
    <h2>Watch — Legal Links & Trailers</h2>
    <p class="muted">We do not host episodes. Use official platforms below:</p>
    <ul>
      <li><a href="https://www.crunchyroll.com/" target="_blank">Crunchyroll</a></li>
      <li><a href="https://www.netflix.com/" target="_blank">Netflix</a></li>
      <li><a href="https://www.hulu.com/" target="_blank">Hulu</a></li>
    </ul>
    <div style="margin-top:12px">
      <h4>Sample trailer slot</h4>
      <div style="background:#000;border-radius:8px;padding:6px">
        <!-- Add YouTube embed URL in the data if you want -->
        <div id="trailerSlot" class="muted">No trailer set. Edit the file to add trailer URLs.</div>
      </div>
    </div>
  </section>

  <!-- CHAT (General) -->
  <section id="chat" class="page card">
    <h2>General Chat</h2>
    <p class="muted">Local-only chat. Messages are stored in your browser.</p>
    <div style="display:flex;gap:10px;margin-top:8px;align-items:center">
      <input id="globalName" placeholder="Your name (will appear on messages)" style="flex:1">
      <button id="clearLocal" class="btn" title="Clears all local chats">Clear Local Data</button>
    </div>
    <div id="globalChat" class="chat" style="margin-top:10px"></div>
    <div style="display:flex;gap:8px;margin-top:8px">
      <input id="globalMsg" placeholder="Write a message..." style="flex:1">
      <button id="sendGlobal" class="btn">Send</button>
    </div>
  </section>

  <!-- RULES -->
  <section id="rules" class="page card">
    <h2>Rules & Reporting</h2>
    <ol class="muted">
      <li>No hate speech or harassment.</li>
      <li>No pornographic content; keep it safe for 13+. </li>
      <li>No sharing pirated episodes. Only link to official platforms.</li>
      <li>Respect other fans. No doxxing or personal attacks.</li>
    </ol>
    <p class="muted">To report a message, copy it and paste it into the contact form in your Text editor or screenshot and send it to the site owner.</p>
  </section>

  <!-- ANIME PAGE (dynamic) -->
  <section id="animePage" class="page card">
    <div id="animeContent"></div>
  </section>

  <!-- FOOTER -->
  <footer>
    Local demo — edit this file in Text to add more anime, images, and episode summaries. Chat is local only.
  </footer>
</main>

<script>
/*
  DATA: modify this block to add more anime, images, seasons, episodes, summaries, and poster URLs.
  Each anime: id (unique), title, poster (URL), synopsis, genres, seasons: array of {seasonNum, summary, episodes: [{ep, title, summary}]}
  movie entries included in movies array.
*/
const animeData = [
  {
    id: 'demon-slayer',
    title: 'Demon Slayer: Kimetsu no Yaiba',
    poster: 'https://i.imgur.com/6YVZL3a.jpg',
    synopsis: 'After his family is slaughtered by demons, Tanjiro joins the Demon Slayer Corps to save his sister Nezuko and fight Muzan.',
    genres:['Action','Dark Fantasy'],
    seasons: [
      { seasonNum:1, summary:'Tanjiro begins training, faces Natagumo and meets Hashira.', episodes:[
        {ep:1, title:'Cruelty', summary:'Tanjiro returns home to find his family massacred and Nezuko turned into a demon.'},
        {ep:2, title:'Trainer', summary:'Tanjiro meets Urokodaki and starts training to become a Demon Slayer.'}
      ]},
      { seasonNum:2, summary:'Mugen Train & Entertainment District arcs.', episodes:[
        {ep:1, title:'Mugen Train – Part 1', summary:'The crew boards the Mugen Train and meets Rengoku.'},
        {ep:2, title:'Entertainment District – Part 1', summary:'They investigate bizarre disappearances in the entertainment district.'}
      ]},
    ],
    movies: [{title:'Demon Slayer – Mugen Train', summary:'Rengoku boards the Mugen Train to battle an evil force.'}],
    gallery: [
      'https://media.giphy.com/media/3o6Zt6ML6BklcajjsA/giphy.gif',
      'https://media.giphy.com/media/l0MYyda8fT3pQ2pOw/giphy.gif'
    ]
  },
  {
    id: 'naruto',
    title: 'Naruto',
    poster: 'https://wallpaperaccess.com/full/1168363.jpg',
    synopsis: 'Naruto Uzumaki seeks recognition and dreams of becoming Hokage while facing many dangers and growing as a ninja.',
    genres:['Shonen','Adventure'],
    seasons: [
      { seasonNum:1, summary:'The early years and first missions.', episodes:[
        {ep:1, title:'Enter: Naruto Uzumaki!', summary:'Naruto causes trouble and begins his journey as a ninja.'},
        {ep:2, title:'The Winning Goal', summary:'Team 7 takes on a survival test.'}
      ]}
    ],
    movies:[{title:'Naruto the Movie', summary:'Various Naruto movie adventures.'}],
    gallery:['https://media.giphy.com/media/xT0xeJpnrWC4XWblEk/giphy.gif']
  },
  {
    id:'one-piece',
    title:'One Piece',
    poster:'https://wallpapercave.com/wp/wp4056410.jpg',
    synopsis:'Monkey D. Luffy forms his pirate crew to find the One Piece and become the King of the Pirates.',
    genres:['Adventure','Pirate'],
    seasons:[{seasonNum:1, summary:'East Blue saga begins.', episodes:[{ep:1,title:'Romance Dawn',summary:'Luffy sets sail on his pirate journey.'}]}],
    movies:[{title:'One Piece Film', summary:'Luffy and crew face a great threat.'}],
    gallery:['https://media.giphy.com/media/3o6Zt8zb1v3A8m0nva/giphy.gif']
  },
  {
    id:'jujutsu',
    title:'Jujutsu Kaisen',
    poster:'https://images8.alphacoders.com/102/1021865.jpg',
    synopsis:'Yuji Itadori swallows a cursed object and joins jujutsu sorcerers to fight curses.',
    genres:['Action','Supernatural'],
    seasons:[{seasonNum:1, summary:'Introducing curses and the Tokyo Jujutsu High students.', episodes:[{ep:1,title:'Ryomen Sukuna',summary:'Yuji swallows Sukuna\'s finger.'}]}],
    movies:[{title:'Jujutsu Kaisen 0', summary:'A prequel movie about Yuta Okkotsu.'}],
    gallery:['https://media.giphy.com/media/1zSz5MVw5zW2c/giphy.gif']
  },
  {
    id:'mha',
    title:'My Hero Academia',
    poster:'https://images5.alphacoders.com/103/1032129.jpg',
    synopsis:'In a world of quirks, Izuku Midoriya trains at U.A. to become the greatest hero.',
    genres:['Action','Superhero'],
    seasons:[{seasonNum:1, summary:'UA begins; Deku trains as a hero.', episodes:[{ep:1,title:'Izuku Midoriya',summary:'Deku dreams of being a hero despite being quirkless.'}]}],
    movies:[{title:'MHA: Two Heroes', summary:'Deku and All Might face a new threat.'}],
    gallery:['https://media.giphy.com/media/3ohc0VVKq8d9kkWwUg/giphy.gif']
  }
];

// default gallery images (you can add more)
let galleryImgs = [
  'https://images.unsplash.com/photo-1542204635-8b7f1b18c2d2?auto=format&fit=crop&w=800&q=60'
];

// ----- Utility & rendering -----
const el = id => document.getElementById(id);

function makeAnimeCard(anime){
  const div = document.createElement('div');
  div.className='anime-card card';
  div.dataset.id=anime.id;
  div.innerHTML = `
    <img src="${anime.poster}" alt="${anime.title}">
    <div class="label">${anime.title}</div>
    <div class="muted small">${anime.genres.join(' • ')}</div>
  `;
  div.addEventListener('click', ()=> openAnime(anime.id));
  return div;
}

function renderPopular(){
  const node = el('popularGrid'); node.innerHTML='';
  animeData.slice(0,4).forEach(a=>node.appendChild(makeAnimeCard(a)));
  renderMovies();
}

function renderMovies(){
  const node = el('movieGrid'); node.innerHTML='';
  animeData.forEach(a=>{
    if(a.movies && a.movies.length){
      const f = document.createElement('div'); f.className='anime-card card';
      f.innerHTML = `<img src="${a.poster}" alt="${a.title}"><div class="label">${a.movies[0].title}</div><div class="muted small">${a.title}</div>`;
      node.appendChild(f);
    }
  });
}

function renderAnimeList(){
  const node = el('animeList'); node.innerHTML='';
  animeData.forEach(a=> node.appendChild(makeAnimeCard(a)));
}

function openAnime(id){
  const anime = animeData.find(x=>x.id===id);
  if(!anime) return alert('Not found');
  const c = el('animeContent'); c.innerHTML='';
  const top = document.createElement('div'); top.className='card';
  top.innerHTML = `
    <div style="display:flex;gap:12px;flex-wrap:wrap">
      <img src="${anime.poster}" style="width:200px;height:280px;object-fit:cover;border-radius:8px">
      <div style="flex:1">
        <h2>${anime.title}</h2>
        <div class="muted">${anime.genres.join(' • ')}</div>
        <p class="muted" style="margin-top:8px">${anime.synopsis}</p>
        <div style="margin-top:10px"><button class="btn" onclick="gotoWatch('${anime.title}')">Watch (links)</button></div>
      </div>
    </div>
  `;
  c.appendChild(top);

  // seasons
  anime.seasons.forEach(s=>{
    const sec = document.createElement('div'); sec.className='season'; sec.style.marginTop='12px';
    sec.innerHTML = `<h3>Season ${s.seasonNum} — summary</h3><div class="muted">${s.summary}</div>`;
    const list = document.createElement('div'); list.className='episodes';
    s.episodes.forEach(ep=>{
      const e = document.createElement('div'); e.className='episode';
      e.innerHTML = `<div style="flex:1"><strong>Ep ${ep.ep}: ${ep.title}</strong><div class="muted small">${ep.summary}</div></div><div><button class="btn" onclick="openEpisode('${anime.id}',${s.seasonNum},${ep.ep})">Open</button></div>`;
      list.appendChild(e);
    });
    sec.appendChild(list);
    c.appendChild(sec);
  });

  // gallery
  if(anime.gallery && anime.gallery.length){
    const g = document.createElement('div'); g.style.marginTop='12px';
    g.innerHTML = `<h3>Gallery</h3><div class="grid"></div>`;
    const grid = g.querySelector('.grid');
    anime.gallery.forEach(u=>{
      const f = document.createElement('figure'); f.innerHTML = `<img src="${u}"><figcaption class="muted small">${anime.title}</figcaption>`;
      grid.appendChild(f);
    });
    c.appendChild(g);
  }

  // movies
  if(anime.movies && anime.movies.length){
    const m = document.createElement('div'); m.style.marginTop='12px';
    m.innerHTML = `<h3>Movies</h3>` + anime.movies.map(mv=>`<div class="card" style="margin-top:8px"><strong>${mv.title}</strong><div class="muted small">${mv.summary}</div></div>`).join('');
    c.appendChild(m);
  }

  // back button and show anime page
  showPage('animePage');
}

// watch page helper
function gotoWatch(title){
  showPage('watch');
  // we can set trailer slot text
  el('trailerSlot').innerText = `Search YouTube for official ${title} trailer and paste URL in the code to show embedded trailer.`;
}

// episode view with local chat
function openEpisode(animeId, seasonNum, epNum){
  const anime = animeData.find(x=>x.id===animeId);
  const season = anime.seasons.find(s=>s.seasonNum===seasonNum);
  const episode = season.episodes.find(e=>e.ep===epNum);
  const c = el('animeContent'); c.innerHTML='';

  const top = document.createElement('div'); top.className='card';
  top.innerHTML = `<h2>${anime.title} — Season ${seasonNum} Episode ${epNum}: ${episode.title}</h2><p class="muted">${episode.summary}</p>`;
  c.appendChild(top);

  const chatCard = document.createElement('div'); chatCard.className='card'; chatCard.style.marginTop='10px';
  chatCard.innerHTML = `<h3>Episode Chat (local)</h3>
    <div class="muted small">Messages stored locally. To simulate a public chat, share your file and messages won't sync across devices.</div>
    <div id="epChat" class="chat" style="margin-top:8px"></div>
    <div style="display:flex;gap:8px;margin-top:8px">
      <input id="epName" placeholder="Your name" style="flex:1">
      <input id="epMsg" placeholder="Message" style="flex:2">
      <button class="btn" id="sendEp">Send</button>
    </div>`;
  c.appendChild(chatCard);

  // show page
  showPage('animePage');

  // load chat
  const roomKey = `chat_${animeId}_s${seasonNum}_e${epNum}`;
  function loadEpChat(){
    const box = el('epChat'); box.innerHTML='';
    const msgs = JSON.parse(localStorage.getItem(roomKey) || '[]');
    msgs.forEach(m=>{
      const d = document.createElement('div'); d.className='msg';
      d.innerHTML = `<div style="font-weight:700">${escapeHtml(m.name)}</div><div class="muted small">${escapeHtml(m.text)}</div>`;
      box.appendChild(d);
    });
    box.scrollTop = box.scrollHeight;
  }
  loadEpChat();

  el('sendEp').onclick = ()=>{
    const name = el('epName').value.trim() || 'Anonymous';
    const text = el('epMsg').value.trim();
    if(!text) return;
    const msgs = JSON.parse(localStorage.getItem(roomKey) || '[]');
    msgs.push({name, text, ts: Date.now()});
    localStorage.setItem(roomKey, JSON.stringify(msgs));
    el('epMsg').value='';
    loadEpChat();
  };
}

// escape for safety
function escapeHtml(str){ return String(str).replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

// routing
document.getElementById('mainNav').addEventListener('click', e=>{
  const btn = e.target.closest('button'); if(!btn) return;
  document.querySelectorAll('#mainNav button').forEach(b=>b.classList.remove('active')); btn.classList.add('active');
  showPage(btn.dataset.route);
});
function showPage(id){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  window.scrollTo({top:0,behavior:'smooth'});
}

// render initial lists
renderPopular(); renderAnimeList(); renderGallery();

// SEARCH
el('searchBtn').addEventListener('click', ()=>{
  const q = el('searchInput').value.trim().toLowerCase();
  if(!q) return alert('Type a search term.');
  const results = animeData.filter(a=> a.title.toLowerCase().includes(q) || (a.synopsis && a.synopsis.toLowerCase().includes(q)));
  if(results.length===0) return alert('No results locally — try different words.');
  // show results page
  showPage('discover');
  const list = el('animeList'); list.innerHTML='';
  results.forEach(r=> list.appendChild(makeAnimeCard(r)));
});

// GALLERY management
function renderGallery(){
  const grid = el('galleryGrid'); grid.innerHTML='';
  galleryImgs.forEach(u=>{
    const f = document.createElement('figure'); f.innerHTML = `<img src="${u}" alt=""><figcaption class="muted small">Image</figcaption>`;
    grid.appendChild(f);
  });
}
el('addImgBtn').addEventListener('click', ()=>{
  const url = el('imgUrl').value.trim();
  if(!url) return alert('Paste an image URL first.');
  galleryImgs.unshift(url);
  el('imgUrl').value='';
  renderGallery();
});

// GENERAL CHAT (local)
const globalChatKey = 'animeverse_global_chat';
function renderGlobal(){
  const box = el('globalChat'); box.innerHTML='';
  const msgs = JSON.parse(localStorage.getItem(globalChatKey) || '[]');
  msgs.forEach(m=>{
    const d = document.createElement('div'); d.className='msg';
    d.innerHTML = `<div style="font-weight:700">${escapeHtml(m.name)}</div><div class="muted small">${escapeHtml(m.text)}</div>`;
    box.appendChild(d);
  });
  box.scrollTop = box.scrollHeight;
}
el('sendGlobal').addEventListener('click', ()=>{
  const name = el('globalName').value.trim() || 'Anon';
  const text = el('globalMsg').value.trim();
  if(!text) return;
  const msgs = JSON.parse(localStorage.getItem(globalChatKey) || '[]');
  msgs.push({name, text, ts:Date.now()});
  localStorage.setItem(globalChatKey, JSON.stringify(msgs));
  el('globalMsg').value='';
  renderGlobal();
});
el('clearLocal').addEventListener('click', ()=>{
  if(!confirm('Clear all local chat data? This will remove general and episode chats.')) return;
  // remove keys we used
  localStorage.removeItem(globalChatKey);
  // remove per-episode items
  Object.keys(localStorage).forEach(k=>{ if(k.startsWith('chat_')) localStorage.removeItem(k); });
  renderGlobal();
  alert('Local chat cleared.');
});
renderGlobal();

// small helper to render gallery on start
function renderGallery(){ const grid = el('galleryGrid'); grid.innerHTML=''; galleryImgs.forEach(u=>{ const f=document.createElement('figure'); f.innerHTML=`<img src="${u}" alt=""><figcaption class="muted small">Image</figcaption>`; grid.appendChild(f); }) }
renderGallery();

</script>
</body>
</html>
